jQuery(function(a){a(".bookable_rooms_action").bind("click",function(d){var b=a(this).next("select")[0];var c=a(this);if(b!==null&&b!==undefined){c.attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif");if(c.data("options")===undefined){c.data("options",a(b).children("option").clone(true))}else{a(b).empty().append(c.data("options").clone(true))}a.ajax({type:"POST",url:STUDIP.ABSOLUTE_URI_STUDIP+"dispatch.php/resources/helpers/bookable_rooms",data:{rooms:_.pluck(b.options,"value"),selected_dates:_.pluck(a('input[name="singledate[]"]:checked'),"value"),singleDateID:a("input[name=singleDateID]").attr("value"),new_date:_.map(a("#day,#month,#year,#start_stunde,#start_minute,#end_stunde,#end_minute"),function(e){return{name:e.id,value:e.value}})},success:function(e){if(a.isArray(e)){if(e.length){var f=_.map(e,function(g){return a(b).children("option[value="+g+"]").text()});b.title="Nicht buchbare RÃ¤ume:".toLocaleString()+" "+f.join(", ")}else{b.title=""}_.each(e,function(g){a(b).children("option[value="+g+"]").remove()})}else{b.title=""}c.attr("src",STUDIP.ASSETS_URL+"images/icons/16/blue/room_clear.png")}})}});a(".bookable_rooms_action").show()});jQuery(function(a){STUDIP.BlockAppointmentsDialog={dialog:null,reloadUrlOnClose:null,initialize:function(b){if(STUDIP.BlockAppointmentsDialog.dialog===null){a.ajax({url:b,data:{},success:function(c){STUDIP.BlockAppointmentsDialog.dialog=jQuery('<div id="BlockAppointmentsDialogbox">'+c.content+"</div>").dialog({show:"",hide:"scale",title:c.title,draggable:true,modal:true,resizable:false,width:Math.min(800,a(window).width()-64),height:"auto",maxHeight:a(window).height(),close:function(){a(this).remove();STUDIP.BlockAppointmentsDialog.dialog=null}});STUDIP.BlockAppointmentsDialog.bindevents()}})}},bindevents:function(){a("form[name$=block_appointments] button[type=submit]").bind("click dblclick",function(){var b=this.name;var c=a("form[name$=block_appointments]")[0];STUDIP.BlockAppointmentsDialog.submit(c,b);return false});a("form[name$=block_appointments] .hasDatePicker").datepicker();a("form[name$=block_appointments] .hasDatePicker").blur();a("#block_appointments_days input:checkbox").click(function(){if(this.id=="block_appointments_days_0"){a("#block_appointments_days input:checkbox").attr("checked",function(b){return b==0})}else{a("#block_appointments_days_0").attr("checked",false)}})},submit:function(c,b){if(c){var d=a(c).serializeArray();d.push({name:b,value:1});STUDIP.BlockAppointmentsDialog.update(c.action,d)}},update:function(b,c){var d=a("#BlockAppointmentsDialogbox").parent().zIndex();a("#BlockAppointmentsDialogbox").parent().zIndex(d-1);a.ajax({type:"POST",url:b,data:c,success:function(e){if(STUDIP.BlockAppointmentsDialog.dialog!==null){if(e.auto_close===true){STUDIP.BlockAppointmentsDialog.dialog.dialog("close");if(e.auto_reload===true&&STUDIP.BlockAppointmentsDialog.reloadUrlOnClose!==null){document.location.replace(STUDIP.BlockAppointmentsDialog.reloadUrlOnClose)}}else{STUDIP.BlockAppointmentsDialog.dialog.dialog("option","title",e.title);a("#BlockAppointmentsDialogbox").html(e.content);a("#BlockAppointmentsDialogbox").parent().zIndex(d);STUDIP.BlockAppointmentsDialog.bindevents()}}}})}}});